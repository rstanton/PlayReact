{"version":3,"sources":["../../../js/dialogs/GenericDialog.jsx"],"names":["GenericDialog","props","state","handleSubmit","bind","handleChange","reuse","inputFields","schema","properties","push","title","x","console","debug","eval","localeCompare","dialog","id","body","JSON","stringify","event","setState","$","target","data","value","preventDefault","db","PouchDB","post","err","doc","error","_id","next","Dialog"],"mappings":"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","file":"GenericDialog.js","sourcesContent":["/**\n * @ToDo Should split the reuse functionality into another component\n */\nclass GenericDialog extends Dialog{\n    constructor(props) {\n        super(props);\n\n        this.state = {\n        };\n\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.handleChange = this.handleChange.bind(this);\n    }\n\n    render() {\n        let reuse = null;\n        if(this.props.reuse){\n            reuse = <div role=\"tabpanel\" className=\"tab-pane\" id=\"reuse\">\n                <p>reuse</p>\n            </div>;\n        }\n\n        let inputFields = [];\n        let props = this.props.schema.properties;\n\n        inputFields.push(<p key={\"label\"}>Create a new {this.props.schema.title}</p>)\n\n        for(let x in props){\n            console.debug(\"Building Input Type for: \"+x);\n            console.debug(eval(\"props.\"+x+\".type\"));\n\n            if(eval(\"props.\"+x+\".type\").localeCompare(\"string\")==0) {\n                inputFields.push(<div key={x}><label htmlFor={\"input\" + x}>{x}</label><input type=\"text\"\n                                                                                             onChange={this.handleChange}\n                                                                                             className=\"form-control\"\n                                                                                             placeholder={\"input \" + x}\n                                                                                             id={\"input\" + x}\n                                                                                             data-title={x}/></div>);\n            }\n            else{\n                inputFields.push(<div key={x}>\n                    <label htmlFor={\"input\" + x}>{x}</label>\n                    <GenericObjectLister/>\n                </div>);\n            }\n        }\n\n        let dialog = <div id={this.props.id}>\n            <p>{this.props.body}</p>\n            <div>\n                <ul className=\"nav nav-tabs\" role=\"tablist\">\n                    <li role=\"presentation\" className=\"active\"><a href=\"#new\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">New</a></li>\n                    {reuse!=null &&\n                    <li role=\"presentation\"><a href=\"#reuse\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">Existing</a></li>\n                    }\n                </ul>\n\n                <div className=\"tab-content\">\n                    <div role=\"tabpanel\" className=\"tab-pane active\" id=\"new\">\n                        <form action=\"#\" onSubmit={this.handleSubmit}>\n                            <div className=\"form-group\">\n                                {inputFields}\n                            </div>\n                            <button type=\"submit\" className=\"btn btn-primary\">Save</button>\n                        </form>\n                        <pre>{JSON.stringify(this.props.schema)}</pre>\n                    </div>\n                    {reuse}\n                </div>\n            </div>\n        </div>;\n\n        return dialog;\n    }\n\n    /**\n     * Updates React State, based on the data attribute set on the input box.\n     * @param event\n     */\n    handleChange(event){\n        this.setState({\n            [$(\"#\"+event.target.id).data(\"title\")]:event.target.value\n        });\n    }\n\n    /**\n     * Saves the object to the database\n     * @param event\n     * @ToDo validate state against the JSON Schema object and respond accordingly\n     */\n    handleSubmit(event){\n        event.preventDefault();\n\n        console.debug(\"Saving \"+this.props.schema.title+\" with \"+JSON.stringify(this.state));\n\n        let db = new PouchDB(this.props.schema.title);\n\n        db.post(this.state, function(err,doc){\n            if(err){\n                console.error(err);\n            }\n            else {\n                $(\"#dialog\" + this.props.schema._id).dialog(\"close\");\n            }\n\n\n            this.setState();\n\n            //If a next action is specified then execute, passing the schema object forward\n            if(this.props.next)\n                this.props.next(this.props.schema);\n\n        }.bind(this));\n    }\n}"]}